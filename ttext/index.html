<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Vocab Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .checkbox-row {
            display: flex;
            align-items: center;
            height: 1.5em;
            padding: 0.25em 0;
        }
        .checkbox-row label {
            width: 2em;
            text-align: right;
            margin-right: 0.5em;
            color: #6b7280;
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 min-h-screen">
    <div class="flex h-screen">
        <!-- Sidebar: Line numbers and checkboxes -->
        <div id="checkboxSidebar" class="bg-gray-100 dark:bg-gray-800 border-r border-gray-300 dark:border-gray-600 p-4 overflow-y-auto" style="min-width: 110px;">
            <!-- Checkbox rows generated here -->
        </div>
        <!-- Main column -->
        <div class="flex flex-col flex-1 relative">
            <textarea
                id="textArea"
                class="flex-1 p-4 text-base border-0 resize-none focus:outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-white font-mono"
                style="line-height: 1.5;"
            ></textarea>
            <div id="statusMessage" class="absolute left-4 bottom-4 text-sm text-gray-600 dark:text-gray-400"></div>
            <div id="checkboxCounter" class="absolute right-4 bottom-4 text-sm text-gray-600 dark:text-gray-400">0/20</div>
        </div>
    </div>
    <script>
        const textArea = document.getElementById('textArea');
        const checkboxSidebar = document.getElementById('checkboxSidebar');
        const checkboxCounter = document.getElementById('checkboxCounter');

        // Store checkbox states
        let checkboxState = {};

        function renderCheckboxSidebar() {
            const lines = textArea.value.split('\n');
            checkboxSidebar.innerHTML = '';

            lines.forEach((line, i) => {
                // Row container
                const row = document.createElement('div');
                row.className = "checkbox-row";

                // Line number label
                const label = document.createElement('label');
                label.textContent = i + 1;
                label.htmlFor = `checkbox_${i}_1`;
                row.appendChild(label);

                // Two checkboxes
                for (let j = 1; j <= 2; j++) {
                    const box = document.createElement('input');
                    box.type = "checkbox";
                    box.id = `checkbox_${i}_${j}`;
                    box.className = "h-4 w-4 rounded bg-gray-200 dark:bg-gray-700 border-gray-300 dark:border-gray-600 focus:ring-2 transition duration-300 mx-1";
                    box.checked = checkboxState[`${i}-${j}`] || false;
                    box.onchange = () => {
                        checkboxState[`${i}-${j}`] = box.checked;
                        updateCheckboxCounter();
                    };
                    row.appendChild(box);
                }

                checkboxSidebar.appendChild(row);
            });
        }

        function updateCheckboxCounter() {
            const boxes = checkboxSidebar.querySelectorAll('input[type="checkbox"]');
            const checked = Array.from(boxes).filter(box => box.checked).length;
            checkboxCounter.textContent = `${checked}/20`;
        }

        function syncSidebarScroll() {
            checkboxSidebar.scrollTop = textArea.scrollTop;
        }

        textArea.addEventListener('input', () => {
            renderCheckboxSidebar();
            syncSidebarScroll();
        });
        textArea.addEventListener('scroll', syncSidebarScroll);

        // On page load
        renderCheckboxSidebar();
        textArea.focus();
    </script>
</body>
</html>
